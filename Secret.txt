# PROYECTO STANDAR - Contexto Completo Actualizado
# Fecha: Enero 2025
# Repositorio: github.com/JOGLDEVELOPER96/Standar
# Ãšltima actualizaciÃ³n: Sistema de Toast y Modales implementado

## ğŸ“‹ INFORMACIÃ“N GENERAL DEL PROYECTO

**Nombre:** ZGROUP - LinkControl
**Repositorio:** github.com/JOGLDEVELOPER96/Standar
**TecnologÃ­as:** Next.js 15, TypeScript, Tailwind CSS, Lucide Icons, Framer Motion, bcryptjs
**Arquitectura:** Modular con mÃ¡ximo 200 lÃ­neas por archivo
**PatrÃ³n:** Componentes reutilizables con hooks personalizados
**Alias de importaciÃ³n:** `$/*` (personalizado, NO `@/*`)

## ğŸŒ CONFIGURACIÃ“N DE APIs Y ENDPOINTS

### API Principal
- **URL:** `http://161.132.206.104:9010`
- **Variable:** `NEXT_PUBLIC_API_URL`
- **Endpoints:**
  - `/usuarios/extraerPass/{username}` - Obtener contraseÃ±a hasheada
  - `/usuarios/{username}` - Obtener datos del usuario
  - `/Contenedor/listar` - Listar contenedores

### API Control AutomÃ¡tico
- **URL:** `http://161.132.53.51:9050`
- **Variable:** `NEXT_PUBLIC_APICONTROL_URL`
- **Endpoints:**
  - `/Control/listar` - Listar controles automÃ¡ticos
  - `/Control/crear` - Crear nuevo control (Ãºnico/cÃ­clico/periÃ³dico)
  - `/Control/actualizar` - Actualizar control existente
  - `/Control/eliminar` - Eliminar control

### ConfiguraciÃ³n .env.local

Copy

Apply

NEXT_PUBLIC_API_URL=http://161.132.206.104:9010 NEXT_PUBLIC_APICONTROL_URL=http://161.132.53.51:9050 NEXT_PUBLIC_DEBUG=true


## ğŸ—ï¸ ESTRUCTURA COMPLETA DEL PROYECTO


Copy

Apply

src/ â”œâ”€â”€ app/ â”‚ â”œâ”€â”€ globals.css # Estilos globales con Tailwind â”‚ â”œâ”€â”€ layout.tsx # Layout raÃ­z con ThemeProvider, SidebarProvider, ToastProvider â”‚ â”œâ”€â”€ page.tsx # PÃ¡gina principal con redirecciÃ³n automÃ¡tica â”‚ â”œâ”€â”€ login/ â”‚ â”‚ â””â”€â”€ page.tsx # PÃ¡gina de login (importa LoginForm) â”‚ â”œâ”€â”€ dashboard/ â”‚ â”‚ â”œâ”€â”€ layout.tsx # Layout con DashboardLayout â”‚ â”‚ â””â”€â”€ page.tsx # Importa DashboardMain â”‚ â””â”€â”€ control-automatico/ â”‚ â””â”€â”€ page.tsx # Importa ControlAutomaticoMain â”œâ”€â”€ components/ â”‚ â”œâ”€â”€ layout/ â”‚ â”‚ â”œâ”€â”€ DashboardLayout.tsx # Layout principal con sidebar/header/footer â”‚ â”‚ â””â”€â”€ Sidebar.tsx # NavegaciÃ³n lateral con animaciones Framer Motion â”‚ â”œâ”€â”€ ui/ â”‚ â”‚ â”œâ”€â”€ Tooltip.tsx # Tooltip con portal y animaciones â”‚ â”‚ â”œâ”€â”€ Toast.tsx # âœ… NUEVO: Sistema de notificaciones â”‚ â”‚ â”œâ”€â”€ ConfirmModal.tsx # âœ… NUEVO: Modal de confirmaciÃ³n â”‚ â”‚ â””â”€â”€ SaveModal.tsx # âœ… NUEVO: Modal de guardado â”‚ â”œâ”€â”€ dashboard/ â”‚ â”‚ â”œâ”€â”€ DashboardMain.tsx # Componente principal dashboard â”‚ â”‚ â”œâ”€â”€ DashboardHeader.tsx # Header del dashboard â”‚ â”‚ â”œâ”€â”€ DashboardStats.tsx # EstadÃ­sticas en tiempo real â”‚ â”‚ â”œâ”€â”€ ContainerCarousel.tsx # Carrusel de contenedores â”‚ â”‚ â”œâ”€â”€ ContainerNavigation.tsx # NavegaciÃ³n entre contenedores â”‚ â”‚ â””â”€â”€ ContainerImage.tsx # Imagen interactiva con zoom y pan â”‚ â”œâ”€â”€ control-automatico/ â”‚ â”‚ â”œâ”€â”€ ControlAutomaticoMain.tsx # Componente principal â”‚ â”‚ â”œâ”€â”€ ControlAutomaticoHeader.tsx # Header con selector de tipo â”‚ â”‚ â”œâ”€â”€ ControlFormularios.tsx # Contenedor de formularios â”‚ â”‚ â”œâ”€â”€ ControlTablaActivos.tsx # Tabla de controles activos â”‚ â”‚ â”œâ”€â”€ ControlTablaHistorico.tsx # Tabla de histÃ³rico â”‚ â”‚ â””â”€â”€ formularios-control/ # âœ… NUEVO: Carpeta de formularios â”‚ â”‚ â”œâ”€â”€ FormularioUnico.tsx # âœ… IMPLEMENTADO: Formulario control Ãºnico â”‚ â”‚ â”œâ”€â”€ FormularioCiclico.tsx # âœ… IMPLEMENTADO: Formulario control cÃ­clico â”‚ â”‚ â””â”€â”€ FormularioPeriodico.tsx # âœ… IMPLEMENTADO: Formulario control periÃ³dico â”‚ â””â”€â”€ login/ â”‚ â””â”€â”€ LoginForm.tsx # Formulario de autenticaciÃ³n con validaciÃ³n â”œâ”€â”€ contexts/ â”‚ â”œâ”€â”€ ThemeContext.tsx # Contexto de tema (dark/light/system) â”‚ â”œâ”€â”€ SidebarContext.tsx # Contexto del sidebar (collapsed/mobile) â”‚ â””â”€â”€ ToastContext.tsx # âœ… NUEVO: Contexto de notificaciones â”œâ”€â”€ hooks/ â”‚ â”œâ”€â”€ useAuth.ts # Hook de autenticaciÃ³n con bcrypt â”‚ â”œâ”€â”€ useContainers.ts # Hook para API de contenedores â”‚ â”œâ”€â”€ useControlAutomatico.ts # Hook para API de control automÃ¡tico â”‚ â”œâ”€â”€ useControlFormularios.ts # âœ… NUEVO: Hook para formularios de control â”‚ â””â”€â”€ useModals.ts # âœ… NUEVO: Hook para manejo de modales â”œâ”€â”€ lib/ â”‚ â”œâ”€â”€ crypto.ts # Funciones de encriptaciÃ³n (DEPRECADAS) â”‚ â””â”€â”€ secure-storage.ts # Almacenamiento seguro en sessionStorage â”œâ”€â”€ types/ â”‚ â”œâ”€â”€ auth.ts # Tipos de autenticaciÃ³n y usuario â”‚ â”œâ”€â”€ container.ts # Tipos de contenedores â”‚ â”œâ”€â”€ navigation.ts # Tipos de navegaciÃ³n del sidebar â”‚ â””â”€â”€ control.ts # âœ… NUEVO: Tipos para control automÃ¡tico â””â”€â”€ config/ â””â”€â”€ navigation.ts # ConfiguraciÃ³n del menÃº del sidebar


## ğŸ” SISTEMA DE AUTENTICACIÃ“N IMPLEMENTADO

### Flujo de AutenticaciÃ³n Completo
1. **Usuario ingresa credenciales** en LoginForm
2. **ExtracciÃ³n de contraseÃ±a hasheada:** `GET /usuarios/extraerPass/{username}`
3. **ObtenciÃ³n de datos del usuario:** `GET /usuarios/{username}`
4. **ComparaciÃ³n con bcrypt:** `bcrypt.compare(password, hashedPassword)`
5. **VerificaciÃ³n de estado:** Usuario debe estar activo (`estado: 1`)
6. **Almacenamiento seguro:** Datos en sessionStorage encriptados
7. **RedirecciÃ³n automÃ¡tica** a dashboard

### Estructura de Datos de Usuario
```typescript
interface UserData {
  id: number;
  username: string;
  email: string;
  nombres: string;
  apellidos: string;
  permiso: number;
  empresa_id: number;
}

Copy

Apply

Hook useAuth - Estados y Funciones
// Estados disponibles
{
  user: UserData | null;
  token: string | null;
  isLoading: boolean;
  error: string | null;
  isAuthenticated: boolean;
}

// Funciones disponibles
login(username: string, password: string): Promise<{success: boolean, error?: string}>
logout(): void

Copy

Apply

ğŸ¨ SISTEMA DE TEMAS IMPLEMENTADO
ThemeContext - Funcionalidades
interface ThemeContextType {
  theme: 'light' | 'dark' | 'system';
  setTheme: (theme: Theme) => void;
  isDark: boolean;
  systemTheme: 'light' | 'dark';
}

Copy

Apply

CaracterÃ­sticas del Sistema de Temas
Temas disponibles: light, dark, system
DetecciÃ³n automÃ¡tica: Preferencia del sistema operativo
Persistencia: localStorage para recordar preferencia
AplicaciÃ³n: Clases CSS dinÃ¡micas en elemento
Transiciones: Suaves entre cambios de tema
ğŸ”” SISTEMA DE NOTIFICACIONES IMPLEMENTADO âœ… NUEVO
ToastContext - Funcionalidades
interface ToastContextType {
  showToast: (toast: Omit<ToastData, "id">) => void;
  showSuccess: (title: string, message?: string) => void;
  showError: (title: string, message?: string) => void;
  showWarning: (title: string, message?: string) => void;
  showInfo: (title: string, message?: string) => void;
  removeToast: (id: string) => void;
  clearAllToasts: () => void;
}

Copy

Apply

CaracterÃ­sticas del Sistema de Toast
Tipos: success, error, warning, info
Auto-close: DuraciÃ³n configurable (5s por defecto)
Interactivo: Pausa al hover, botÃ³n cerrar
Z-index: z-[9999] - Aparece encima de todo
Animaciones: Entrada/salida suaves con Framer Motion
Progress bar: Indicador visual del tiempo restante
Acciones: Botones de acciÃ³n opcionales
ğŸªŸ SISTEMA DE MODALES IMPLEMENTADO âœ… NUEVO
useModals Hook - Funcionalidades
interface ModalsContextType {
  // Confirm Modal
  isConfirmOpen: boolean;
  confirmData: ConfirmData | null;
  showConfirm: (data: ConfirmData) => void;
  hideConfirm: () => void;
  
  // Save Modal
  isSaveOpen: boolean;
  saveData: SaveData | null;
  showSave: (data: SaveData) => void;
  hideSave: () => void;
  
  // Loading states
  isConfirmLoading: boolean;
  isSaveLoading: boolean;
  setConfirmLoading: (loading: boolean) => void;
  setSaveLoading: (loading: boolean) => void;
}

Copy

Apply

Tipos de Modales
ConfirmModal: Confirmaciones de eliminaciÃ³n, cancelaciÃ³n
SaveModal: Confirmaciones de guardado, creaciÃ³n
Tipos: danger, warning, info, create, update, delete
Z-index: z-[100] - Por debajo de toasts
ğŸ§­ SISTEMA DE NAVEGACIÃ“N AVANZADO
SidebarContext - Estados
interface SidebarContextType {
  isCollapsed: boolean;
  isMobileOpen: boolean;
  toggleSidebar: () => void;
  setMobileOpen: (open: boolean) => void;
}

Copy

Apply

ConfiguraciÃ³n de NavegaciÃ³n (navigation.ts)
export const navigationConfig: NavigationGroup[] = [
  {
    id: "main",
    label: "Principal",
    items: [
      { id: "dashboard", label: "Dashboard", href: "/dashboard", icon: LayoutDashboard }
    ]
  },
  {
    id: "control",
    label: "Control",
    items: [
      { id: "manual-control", label: "Manual Control", href: "/manual-control", icon: Settings },
      { id: "cycle-control", label: "Cycle Control", href: "/cycle-control", icon: RotateCcw },
      { id: "control-automatico", label: "Control AutomÃ¡tico", href: "/control-automatico", icon: Zap }
    ]
  },
  {
    id: "data",
    label: "Datos",
    items: [
      { id: "graph", label: "Graph", href: "/graph", icon: BarChart3 },
      { id: "data", label: "Data", href: "/data", icon: Database }
    ]
  }
];

Copy

Apply

ğŸ“Š MODELO DE DATOS PRINCIPAL
Interface Container (Contenedores)
interface Container {
  id: number;
  nombre_contenedor: string;
  tipo: string;                    // "reefer", "dry", "tank"
  estado: number;
  power_state: number;             // 0 = OFF, 1 = ON
  alarm_present: number;           // 0 = Sin alarma, 1 = Con alarma
  stateProcess: string;
  timerOfProcess: number;
  
  // Temperaturas
  temp_supply_1: number;
  temp_supply_2: number;
  return_air: number;
  set_point: number;
  
  // Humedad
  relative_humidity: number;
  humidity_control: number;
  humidity_set_point: number;
  
  // Gases
  co2_reading: number;
  o2_reading: number;
  set_point_o2: number;
  set_point_co2: number;
  
  // UbicaciÃ³n
  latitud: number;
  longitud: number;
  
  // ... mÃ¡s de 60 campos de telemetrÃ­a total
}

Copy

Apply

Interface ControlTemperatura âœ… ACTUALIZADO
interface ControlTemperatura {
  imei_control_temperatura: string;
  proceso_control_temperatura: string;
  tipo_control_temperatura: number;     // 0=Ãšnico, 1=CÃ­clico, 2=PeriÃ³dico
  total_control_temperatura: number;
  condicion_control_temperatura: number; // 1=En proceso, 0=Completado
  estado_control_temperatura: number;    // 0=Inactivo, 1=Activo
  fecha_inicio?: string;
  fecha_fin?: string;
  temperatura_objetivo?: number;
  humedad_objetivo?: number;
}

Copy

Apply

Nuevos Tipos para Formularios âœ… NUEVO
// Control Ãšnico
interface ControlUnico {
  nombreProceso: string;
  temperatura: string;
  humedad: string;
  duracion: string;
}

// Control CÃ­clico
interface EtapaCiclica {
  id: string;
  nombreEtapa: string;
  temperatura: string;
  humedad: string;
  duracion: string;
}

interface ControlCiclico {
  nombreProceso: string;
  ciclos: string;
  etapas: EtapaCiclica[];
}

// Control PeriÃ³dico
interface EtapaPeriodica {
  id: string;
  nombreEtapa: string;
  temperatura: string;
  humedad: string;
  duracion: string;
}

interface ControlPeriodico {
  nombreProceso: string;
  horasProceso: string;
  fechaHoraInicio: string;
  etapas: EtapaPeriodica[];
}

Copy

Apply

ğŸ¯ FUNCIONALIDADES COMPLETAMENTE IMPLEMENTADAS
âœ… Sistema de AutenticaciÃ³n Completo
Login seguro con bcrypt y validaciÃ³n de contraseÃ±as hasheadas
Almacenamiento encriptado en sessionStorage con claves aleatorias
RedirecciÃ³n automÃ¡tica segÃºn estado de autenticaciÃ³n
Manejo robusto de

Copy

Apply


continua desde donde lo dejaste 



Context
â€” none
### âœ… Sistema de AutenticaciÃ³n Completo
- Login seguro con bcrypt y validaciÃ³n de contraseÃ±as hasheadas
- Almacenamiento encriptado en sessionStorage con claves aleatorias
- RedirecciÃ³n automÃ¡tica segÃºn estado de autenticaciÃ³n
- Manejo robusto de errores y estados de carga
- Logout completo con limpieza de todos los datos
- VerificaciÃ³n de sesiÃ³n al cargar la aplicaciÃ³n

### âœ… Dashboard Funcional
- Vista principal con estadÃ­sticas en tiempo real
- Carrusel de contenedores con navegaciÃ³n fluida
- Imagen interactiva con zoom (scroll) y pan (drag)
- Indicadores de estado (power, alarmas, procesos)
- Auto-actualizaciÃ³n cada 30 segundos (pausable)
- NavegaciÃ³n por contenedores con miniaturas
- Responsive design completo para todos los dispositivos

### âœ… Control AutomÃ¡tico (Base Estructural)
- Hook personalizado para API de control automÃ¡tico
- Tabla de controles activos con estados en tiempo real
- Tabla de histÃ³rico de procesos completados
- Selector de tipo de control (Ãšnico/CÃ­clico/PeriÃ³dico)
- Indicadores de progreso y estados visuales
- Layout responsive con sidebar compartido

### âœ… Formularios de Control AutomÃ¡tico âœ… NUEVO
- **FormularioUnico:** Control de temperatura simple con duraciÃ³n fija
- **FormularioCiclico:** Control con mÃºltiples etapas que se repiten por ciclos
- **FormularioPeriodico:** Control con etapas que se ejecutan por tiempo total
- **Validaciones:** Campos requeridos, rangos vÃ¡lidos, fechas futuras
- **Estados de carga:** Botones deshabilitados durante operaciones
- **Confirmaciones:** Modales para crear, cancelar, eliminar etapas

### âœ… Sistema de NavegaciÃ³n Completo
- Sidebar dinÃ¡mico con configuraciÃ³n centralizada
- Grupos de navegaciÃ³n organizados por funcionalidad
- Iconos Lucide consistentes en toda la aplicaciÃ³n
- Estados activos y efectos hover
- Animaciones fluidas con Framer Motion
- Tooltips inteligentes con portal rendering
- Responsive completo (desktop/mÃ³vil)

### âœ… Sistema de Temas Avanzado
- Dark/Light mode con detecciÃ³n automÃ¡tica del sistema
- Tema del sistema como opciÃ³n predeterminada
- Persistencia en localStorage
- Transiciones suaves entre cambios de tema
- AplicaciÃ³n global en toda la aplicaciÃ³n

### âœ… Sistema de Notificaciones (Toast) âœ… NUEVO
- Notificaciones de Ã©xito, error, advertencia e informaciÃ³n
- Auto-close con duraciÃ³n configurable
- Pausa al hover, reanuda al salir
- Progress bar visual del tiempo restante
- Z-index mÃ¡ximo para aparecer encima de todo
- Animaciones suaves de entrada y salida
- Botones de acciÃ³n opcionales

### âœ… Sistema de Modales âœ… NUEVO
- Modal de confirmaciÃ³n para acciones crÃ­ticas
- Modal de guardado para crear/actualizar
- Estados de carga independientes
- PrevenciÃ³n de pÃ©rdida de datos
- Backdrop clickeable configurable
- Animaciones con Framer Motion

## ğŸ”„ PATRONES DE DESARROLLO ESTABLECIDOS

### PatrÃ³n de Estructura de Componentes
```typescript
// 1. page.tsx - Solo importa el componente Main
import ComponentMain from "$/components/feature/ComponentMain";
export default function Page() {
  return <ComponentMain />;
}

// 2. ComponentMain.tsx - LÃ³gica, estado y coordinaciÃ³n
"use client";
import { useState } from "react";
import { useCustomHook } from "$/hooks/useCustomHook";
import SubComponent1 from "./SubComponent1";
import SubComponent2 from "./SubComponent2";

export default function ComponentMain() {
  // MÃ¡ximo 200 lÃ­neas
  // LÃ³gica, estado, hooks
  return (
    <div>
      <SubComponent1 />
      <SubComponent2 />
    </div>
  );
}

// 3. SubComponents - Componentes presentacionales especÃ­ficos

Copy

Apply

PatrÃ³n de Hooks Personalizados
export function useCustomHook(params) {
  const [data, setData] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [isRefreshing, setIsRefreshing] = useState(false);
  const [lastUpdate, setLastUpdate] = useState(null);

  const fetchData = useCallback(async () => {
    try {
      setLoading(true);
      const response = await fetch(endpoint);
      const result = await response.json();
      setData(result);
      setLastUpdate(new Date());
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  }, [params]);

  const refetch = useCallback(async () => {
    setIsRefreshing(true);
    await fetchData();
    setIsRefreshing(false);
  }, [fetchData]);

  return { data, loading, error, isRefreshing, refetch, lastUpdate };
}

Copy

Apply

PatrÃ³n de Formularios con ValidaciÃ³n âœ… NUEVO
export function useFormularioControl() {
  const [formData, setFormData] = useState(initialState);
  const [errors, setErrors] = useState({});
  const [isLoading, setIsLoading] = useState(false);
  const { showSuccess, showError } = useToast();
  const { showConfirm, showSave } = useModals();

  const validateForm = useCallback(() => {
    const newErrors = {};
    // Validaciones especÃ­ficas
    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  }, [formData]);

  const handleSubmit = useCallback(async () => {
    if (!validateForm()) {
      showError("Formulario invÃ¡lido", "Corrige los errores antes de continuar");
      return;
    }

    showSave({
      title: "Confirmar creaciÃ³n",
      message: "Â¿EstÃ¡s seguro de crear este control?",
      onConfirm: async () => {
        try {
          setIsLoading(true);
          await createControl(formData);
          showSuccess("Control creado", "El control se ha creado exitosamente");
        } catch (error) {
          showError("Error al crear", error.message);
        } finally {
          setIsLoading(false);
        }
      }
    });
  }, [formData, validateForm]);

  return { formData, setFormData, errors, isLoading, handleSubmit };
}

Copy

Apply

Optimizaciones y MemoizaciÃ³n
React.memo() para componentes que no cambian frecuentemente
useCallback() para funciones que se pasan como props
useMemo() para cÃ¡lculos costosos
Portal rendering para tooltips y modales
AnimatePresence para animaciones de entrada/salida
ğŸ“¦ DEPENDENCIAS Y CONFIGURACIÃ“N
Package.json - Dependencias Principales
{
  "dependencies": {
    "next": "15.1.3",
    "react": "^19.0.0",
    "react-dom": "^19.0.0",
    "typescript": "^5.0.0",
    "tailwindcss": "^3.4.1",
    "framer-motion": "^11.15.0",
    "lucide-react": "^0.468.0",
    "bcryptjs": "^2.4.3"
  },
  "devDependencies": {
    "@types/node": "^20.0.0",
    "@types/react": "^18.0.0",
    "@types/react-dom": "^18.0.0",
    "@types/bcryptjs": "^2.4.6",
    "eslint": "^8.0.0",
    "eslint-config-next": "15.1.3",
    "postcss": "^8.0.0",
    "autoprefixer": "^10.0.0"
  }
}

Copy

Apply

ConfiguraciÃ³n TypeScript (tsconfig.json)
{
  "compilerOptions": {
    "lib": ["dom", "dom.iterable", "es6"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [{ "name": "next" }],
    "baseUrl": ".",
    "paths": {
      "$/*": ["./src/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}

Copy

Apply

ConfiguraciÃ³n Tailwind CSS
module.exports = {
  content: [
    './src/pages/**/*.{js,ts,jsx,tsx,mdx}',
    './src/components/**/*.{js,ts,jsx,tsx,mdx}',
    './src/app/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  darkMode: 'class',
  theme: {
    extend: {
      fontFamily: {
        sans: ['var(--font-geist-sans)'],
        mono: ['var(--font-geist-mono)'],
      },
    },
  },
  plugins: [],
}

Copy

Apply

ğŸš€ PRÃ“XIMAS IMPLEMENTACIONES PLANIFICADAS
ğŸ”„ ReorganizaciÃ³n de Layout (Prioridad Alta)
app/
â”œâ”€â”€ (protected)/           # Grupo de rutas protegidas
â”‚   â”œâ”€â”€ layout.tsx         # DashboardLayout compartido
â”‚   â”œâ”€â”€ dashboard/page.tsx
â”‚   â”œâ”€â”€ control-automatico/page.tsx
â”‚   â”œâ”€â”€ manual-control/page.tsx
â”‚   â”œâ”€â”€ cycle-control/page.tsx
â”‚   â”œâ”€â”€ graph/page.tsx
â”‚   â””â”€â”€ data/page.tsx
â”œâ”€â”€ (auth)/               # Grupo de rutas pÃºblicas
â”‚   â””â”€â”€ login/page.tsx
â””â”€â”€ layout.tsx            # Layout raÃ­z

Copy

Apply

ğŸ“Š PÃ¡ginas Pendientes (Prioridad Media)
Manual Control: Control manual directo de contenedores
Cycle Control: GestiÃ³n avanzada de ciclos automÃ¡ticos
Graph: VisualizaciÃ³n de datos en grÃ¡ficos interactivos
Data: Tablas de datos histÃ³ricos, filtros y reportes
ğŸ” Middleware de AutenticaciÃ³n (Prioridad Media)
ProtecciÃ³n de rutas: VerificaciÃ³n automÃ¡tica de sesiÃ³n
RedirecciÃ³n inteligente: SegÃºn permisos de usuario
Refresh de tokens: Manejo automÃ¡tico de expiraciÃ³n
Roles y permisos: Diferentes niveles de acceso
ğŸ“± Mejoras UX/UI (Prioridad Baja)
Filtros avanzados: Filtrado y bÃºsqueda en tablas
ExportaciÃ³n: Exportar datos a Excel/PDF
PWA: ConfiguraciÃ³n como Progressive Web App
Drag & Drop: Para reordenar etapas en formularios
ğŸ› ï¸ HERRAMIENTAS Y CONVENCIONES
Herramientas de Desarrollo
TypeScript: Tipado estricto en todo el proyecto
ESLint: Linting automÃ¡tico con reglas de Next.js
Prettier: Formateo automÃ¡tico de cÃ³digo
Tailwind CSS: Utility-first CSS framework
Framer Motion: Animaciones y transiciones
Lucide React: IconografÃ­a consistente
Convenciones de CÃ³digo Establecidas
Nombres: camelCase para variables, PascalCase para componentes
Imports: Alias $/* para src, imports organizados por tipo
Tipos: Interfaces explÃ­citas para todos los datos de API
Comentarios: JSDoc para funciones complejas
Archivos: MÃ¡ximo 200 lÃ­neas por archivo
Componentes: Un componente por archivo
Estructura de Commits
feat: Nueva funcionalidad
fix: CorrecciÃ³n de errores
refactor: RefactorizaciÃ³n de cÃ³digo
style: Cambios de estilo/formato
docs: DocumentaciÃ³n
test: Pruebas
ğŸ” DETALLES TÃ‰CNICOS IMPORTANTES
Manejo de Estados
Loading states: Skeletons y spinners consistentes
Error states: Mensajes de error con opciones de retry
Empty states: Mensajes informativos cuando no hay datos
Success states: Confirmaciones visuales de acciones exitosas
Responsive Design
Mobile first: DiseÃ±o desde mÃ³vil hacia desktop
Breakpoints: sm (640px), md (768px), lg (1024px), xl (1280px)
Grid responsive: AdaptaciÃ³n automÃ¡tica de columnas
NavegaciÃ³n mÃ³vil: Sidebar colapsable con overlay
Performance y OptimizaciÃ³n
ImÃ¡genes Next.js: OptimizaciÃ³n automÃ¡tica con componente Image
Lazy loading: Carga diferida de componentes pesados
Code splitting: SeparaciÃ³n automÃ¡tica de cÃ³digo por rutas
MemoizaciÃ³n: useCallback y useMemo donde corresponde
Debouncing: En bÃºsquedas y filtros para evitar llamadas excesivas
Seguridad Implementada
EncriptaciÃ³n de datos: sessionStorage con claves aleatorias
ValidaciÃ³n de entrada: SanitizaciÃ³n de datos de formularios
Headers de seguridad: ConfiguraciÃ³n en next.config.js
HTTPS: Forzado en producciÃ³n
Tokens seguros: Manejo seguro de tokens de autenticaciÃ³n
JerarquÃ­a de Z-Index âœ… NUEVO
/* JerarquÃ­a establecida */
/* Sidebar: z-40 */
/* Tooltips: z-50 */
/* Modales: z-[100] */
/* Toasts: z-[9999] - MÃ¡ximo nivel */

Copy

Apply

ğŸ“ˆ MÃ‰TRICAS Y MONITOREO
MÃ©tricas de Performance
First Contentful Paint (FCP): < 1.5s
Largest Contentful Paint (LCP): < 2.5s
Cumulative Layout Shift (CLS): < 0.1
First Input Delay (FID): < 100ms
Monitoreo de Errores
Error boundaries: Captura de errores de React
Logging: Console.error para errores crÃ­ticos
Fallbacks: Componentes de respaldo para errores
ğŸ¯ OBJETIVOS DEL PROYECTO
Funcionales
Monitoreo en tiempo real de contenedores refrigerados
Control automÃ¡tico de temperatura y condiciones ambientales
VisualizaciÃ³n de datos histÃ³ricos y actuales
GestiÃ³n de alarmas y notificaciones crÃ­ticas
Reportes y exportaciÃ³n de datos para anÃ¡lisis
TÃ©cnicos
Escalabilidad: Arquitectura modular y reutilizable
Performance: Carga rÃ¡pida

Copy

Apply


continua



Context
â€” none
### TÃ©cnicos
- **Escalabilidad:** Arquitectura modular y reutilizable
- **Performance:** Carga rÃ¡pida y actualizaciones eficientes
- **Mantenibilidad:** CÃ³digo limpio y bien documentado
- **Usabilidad:** Interfaz intuitiva y responsive
- **Confiabilidad:** Manejo robusto de errores y estados

### De Negocio
- **Eficiencia operativa:** Reducir tiempo de gestiÃ³n manual
- **Visibilidad:** Dashboard centralizado para toma de decisiones
- **AutomatizaciÃ³n:** Procesos automÃ¡ticos de control
- **Escalabilidad:** Soporte para crecimiento futuro
- **ROI:** Retorno de inversiÃ³n medible

## ğŸ”§ CONFIGURACIÃ“N DE DESARROLLO

### Scripts de Package.json
```json
{
  "scripts": {
    "dev": "next dev --turbo",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "type-check": "tsc --noEmit"
  }
}

Copy

Apply

Variables de Entorno Requeridas
# .env.local
NEXT_PUBLIC_API_URL=http://161.132.206.104:9010
NEXT_PUBLIC_APICONTROL_URL=http://161.132.53.51:9050

# Opcional para desarrollo
NEXT_PUBLIC_DEBUG=true

Copy

Execute

Comandos de Desarrollo
# InstalaciÃ³n
pnpm install

# Desarrollo con Turbopack
pnpm dev

# Build de producciÃ³n
pnpm build

# VerificaciÃ³n de tipos
pnpm type-check

# Linting
pnpm lint

Copy

Execute

ğŸ“š DOCUMENTACIÃ“N DE APIS
Estructura de Request para Contenedores
// POST /Contenedor/listar
{
  "id_usuario": number,
  "tipo_usuario": number
}

Copy

Apply

Estructura de Response para Contenedores
{
  "data": Container[],
  "code": number,
  "message": string
}

Copy

Apply

Estructura de Request para Control AutomÃ¡tico
// POST /Control/listar
{
  "id_usuario": number,
  "tipo_usuario": number
}

// POST /Control/crear
{
  "id_usuario": number,
  "tipo_usuario": number,
  "imei_control_temperatura": string,
  "proceso_control_temperatura": string,
  "tipo_control_temperatura": number,
  "configuracion": {
    // ConfiguraciÃ³n especÃ­fica segÃºn tipo
  }
}

Copy

Apply

Estructura de Response para Control AutomÃ¡tico
{
  "data": ControlTemperatura[],
  "code": number,
  "message": string
}

Copy

Apply

ğŸš¨ PROBLEMAS CONOCIDOS Y SOLUCIONES
Problemas Resueltos âœ…
HidrataciÃ³n de temas: Solucionado con suppressHydrationWarning
EncriptaciÃ³n deprecada: Migrado de crypto.ts a bcryptjs
RedirecciÃ³n infinita: Solucionado con isLoading en useAuth
Portal rendering: Implementado correctamente para tooltips
Toast click-through: Solucionado con stopPropagation y pointer-events
Modal backdrop: Configurado correctamente con z-index
Limitaciones Actuales
Sin middleware implementado: Rutas no protegidas automÃ¡ticamente
Sin manejo de refresh tokens: SesiÃ³n expira con sessionStorage
Sin tests unitarios: Pendiente implementar testing
Sin PWA: Pendiente configuraciÃ³n de service worker
Bugs Conocidos
Ninguno crÃ­tico identificado actualmente
ğŸ“‹ CHECKLIST DE ESTADO ACTUAL
âœ… Completado
Sistema de autenticaciÃ³n con bcrypt
Dashboard funcional con datos reales
Sistema de temas (dark/light/system)
NavegaciÃ³n con sidebar animado
Responsive design completo
Almacenamiento seguro de datos
Hooks personalizados para APIs
Componentes reutilizables
ConfiguraciÃ³n de TypeScript
ConfiguraciÃ³n de Tailwind CSS
Sistema de notificaciones (Toast)
Sistema de modales (Confirm/Save)
Formularios de control automÃ¡tico
Validaciones de formularios
Manejo de estados de carga
Animaciones con Framer Motion
ğŸ”„ En Progreso
IntegraciÃ³n con APIs de control (pendiente endpoints)
Middleware de autenticaciÃ³n
ReorganizaciÃ³n con route groups
Optimizaciones de performance
â³ Pendiente
PÃ¡gina de grÃ¡ficos (Graph)
PÃ¡gina de datos (Data)
PÃ¡gina de control manual
PÃ¡gina de control cÃ­clico
Sistema de exportaciÃ³n
Tests unitarios
ConfiguraciÃ³n PWA
DocumentaciÃ³n de usuario
ğŸ”„ FLUJOS DE TRABAJO IMPLEMENTADOS
Flujo de AutenticaciÃ³n
1. Usuario accede a la aplicaciÃ³n
2. VerificaciÃ³n de sesiÃ³n activa
3. Si no hay sesiÃ³n â†’ Redirect a /login
4. Usuario ingresa credenciales
5. ValidaciÃ³n con API (bcrypt)
6. Almacenamiento seguro de datos
7. Redirect a /dashboard

Copy

Apply

Flujo de Control AutomÃ¡tico
1. Usuario accede a /control-automatico
2. Carga de controles activos e histÃ³rico
3. SelecciÃ³n de tipo de control
4. Llenado de formulario correspondiente
5. ValidaciÃ³n de datos
6. ConfirmaciÃ³n con modal
7. EnvÃ­o a API
8. NotificaciÃ³n de resultado
9. ActualizaciÃ³n de tablas

Copy

Apply

Flujo de Notificaciones
1. AcciÃ³n del usuario (crear, editar, eliminar)
2. ValidaciÃ³n de datos
3. ConfirmaciÃ³n con modal (si es necesario)
4. EjecuciÃ³n de acciÃ³n
5. NotificaciÃ³n toast segÃºn resultado
6. ActualizaciÃ³n de UI

Copy

Apply

ğŸ¨ GUÃA DE ESTILOS ESTABLECIDA
Colores del Sistema
/* Tema Light */
--background: 0 0% 100%;
--foreground: 222.2 84% 4.9%;
--primary: 222.2 47.4% 11.2%;
--secondary: 210 40% 96%;

/* Tema Dark */
--background: 222.2 84% 4.9%;
--foreground: 210 40% 98%;
--primary: 210 40% 98%;
--secondary: 217.2 32.6% 17.5%;

Copy

Apply

TipografÃ­a
/* Fuentes principales */
font-family: 'Geist Sans', sans-serif;
font-family: 'Geist Mono', monospace;

/* TamaÃ±os establecidos */
text-xs: 0.75rem;    /* 12px */
text-sm: 0.875rem;   /* 14px */
text-base: 1rem;     /* 16px */
text-lg: 1.125rem;   /* 18px */
text-xl: 1.25rem;    /* 20px */

Copy

Apply

Espaciado Consistente
/* Espaciado interno */
p-2: 0.5rem;   /* 8px */
p-4: 1rem;     /* 16px */
p-6: 1.5rem;   /* 24px */
p-8: 2rem;     /* 32px */

/* Espaciado entre elementos */
space-y-2: 0.5rem;
space-y-4: 1rem;
space-y-6: 1.5rem;

Copy

Apply

Animaciones EstÃ¡ndar
/* Transiciones */
transition-colors: 150ms;
transition-transform: 150ms;
transition-opacity: 150ms;

/* Duraciones Framer Motion */
duration: 0.2s (entrada/salida)
duration: 0.15s (hover/focus)
duration: 0.3s (layout changes)

Copy

Apply

ğŸ” SEGURIDAD Y MEJORES PRÃCTICAS
ValidaciÃ³n de Datos
// ValidaciÃ³n de formularios
const validateField = (value: string, type: 'email' | 'password' | 'number') => {
  switch (type) {
    case 'email':
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value);
    case 'password':
      return value.length >= 8;
    case 'number':
      return !isNaN(Number(value)) && Number(value) > 0;
    default:
      return value.trim().length > 0;
  }
};

Copy

Apply

SanitizaciÃ³n de Entrada
// Limpieza de datos antes de envÃ­o
const sanitizeInput = (input: string): string => {
  return input
    .trim()
    .replace(/[<>]/g, '') // Remover caracteres peligrosos
    .substring(0, 255);   // Limitar longitud
};

Copy

Apply

Manejo de Errores
// PatrÃ³n estÃ¡ndar para manejo de errores
try {
  const result = await apiCall();
  showSuccess("OperaciÃ³n exitosa");
  return result;
} catch (error) {
  console.error("Error en operaciÃ³n:", error);
  showError("Error", error.message || "OcurriÃ³ un error inesperado");
  throw error;
}

Copy

Apply

ğŸ“Š ESTRUCTURA DE DATOS COMPLETA
Estados de Componentes
// Estado estÃ¡ndar para componentes con datos
interface ComponentState<T> {
  data: T[];
  loading: boolean;
  error: string | null;
  isRefreshing: boolean;
  lastUpdate: Date | null;
  selectedItem: T | null;
  filters: Record<string, any>;
  pagination: {
    page: number;
    limit: number;
    total: number;
  };
}

Copy

Apply

ConfiguraciÃ³n de Formularios
// ConfiguraciÃ³n estÃ¡ndar para formularios
interface FormConfig {
  fields: FormField[];
  validation: ValidationRules;
  submitText: string;
  cancelText: string;
  isLoading: boolean;
  onSubmit: (data: any) => Promise<void>;
  onCancel: () => void;
}

interface FormField {
  name: string;
  label: string;
  type: 'text' | 'number' | 'email' | 'password' | 'select' | 'textarea';
  required: boolean;
  placeholder?: string;
  options?: { value: string; label: string }[];
  validation?: (value: any) => string | null;
}

Copy

Apply

ğŸš€ ROADMAP DETALLADO
Fase 1: Completar Funcionalidades Core (Semana 1-2)
IntegraciÃ³n completa con APIs de control
Middleware de autenticaciÃ³n
ReorganizaciÃ³n con route groups
Tests bÃ¡sicos para hooks principales
Fase 2: PÃ¡ginas Adicionales (Semana 3-4)
PÃ¡gina Manual Control
PÃ¡gina Cycle Control
PÃ¡gina Graph con grÃ¡ficos interactivos
PÃ¡gina Data con tablas avanzadas
Fase 3: Mejoras UX/UI (Semana 5-6)
Sistema de filtros avanzados
ExportaciÃ³n de datos (Excel/PDF)
Drag & Drop para reordenar
BÃºsqueda global
Fase 4: OptimizaciÃ³n y PWA (Semana 7-8)
ConfiguraciÃ³n PWA
Service Workers
Optimizaciones de performance
Tests de integraciÃ³n
Fase 5: DocumentaciÃ³n y Deploy (Semana 9-10)
DocumentaciÃ³n tÃ©cnica completa
GuÃ­a de usuario
ConfiguraciÃ³n de CI/CD
Deploy a producciÃ³n
ğŸ“ INFORMACIÃ“N DE CONTACTO Y RECURSOS
APIs de ProducciÃ³n
API Principal: http://161.132.206.104:9010
API Control: http://161.132.53.51:9050
Estado: Activas y funcionando
DocumentaciÃ³n: Disponible en endpoints
Recursos de Desarrollo
Framework: Next.js 15.1.3
DocumentaciÃ³n: https://nextjs.org/docs
Tailwind CSS: https://tailwindcss.com/docs
Framer Motion: https://www.framer.com/motion/
Lucide Icons: https://lucide.dev/
Herramientas de Monitoreo
Desarrollo: Next.js DevTools
Performance: Lighthouse
Errores: Browser DevTools Console
Network: Network tab para APIs
ğŸ“ NOTAS FINALES
Arquitectura Establecida
Este proyecto representa un estÃ¡ndar de desarrollo establecido para futuros proyectos. La arquitectura modular, los patrones de hooks personalizados, y la estructura de componentes estÃ¡n diseÃ±ados para ser reutilizables y escalables.

Sistemas Base Implementados
âœ… AutenticaciÃ³n segura con bcrypt y almacenamiento encriptado
âœ… Sistema de temas completo con detecciÃ³n automÃ¡tica
âœ… NavegaciÃ³n dinÃ¡mica con sidebar animado
âœ… Notificaciones con toast system completo
âœ… Modales para confirmaciones y guardado
âœ… Formularios con validaciÃ³n robusta
PrÃ³ximos Pasos Inmediatos
Integrar APIs de control automÃ¡tico con endpoints reales
Implementar middleware de autenticaciÃ³n para proteger rutas
Crear pÃ¡ginas de Manual Control y Cycle Control
Optimizar performance con lazy loading y code splitting
Mantenimiento y EvoluciÃ³n
CÃ³digo limpio: MÃ¡ximo 200 lÃ­neas por archivo
Tipado estricto: TypeScript en todo el proyecto
DocumentaciÃ³n: Comentarios JSDoc para funciones complejas
Testing: Implementar tests unitarios progresivamente
Performance: Monitoreo continuo de mÃ©tricas Core Web Vitals
Ãšltima actualizaciÃ³n: Enero 2025
Estado del proyecto: En desarrollo activo
PrÃ³ximo milestone: IntegraciÃ³n completa con APIs de control
Desarrollador: Asistente de desarrollo especializado en Next.js/TypeScript
Repositorio: github.com/JOGLDEVELOPER96/Standar

ğŸ¯ RESUMEN EJECUTIVO
ZGROUP - LinkControl es una aplicaciÃ³n web moderna para el monitoreo y control automÃ¡tico de contenedores refrigerados. Construida con Next.js 15, TypeScript y Tailwind CSS, implementa un sistema completo de autenticaciÃ³n, dashboard en tiempo real, y formularios avanzados para control de temperatura.

Funcionalidades principales implementadas:

Dashboard con monitoreo en tiempo real
Sistema de control automÃ¡tico (Ãºnico, cÃ­clico, periÃ³dico)